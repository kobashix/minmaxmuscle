<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MinMaxMuscle | Peptides</title>
  <link rel="stylesheet" href="assets/css/style.css" />
</head>

<body>

<!-- ================= HEADER ================= -->
<header>
  <div class="nav-container">
    <div class="logo">
      <img src="assets/img/logo.png" alt="MinMaxMuscle Logo" />
      <span>MINMAXMUSCLE</span>
    </div>

    <nav class="desktop-nav">
      <a href="index.html">Home</a>
      <a href="training.html">Training</a>
      <a href="nutrition.html">Nutrition</a>
      <a href="peptidesdb.html" class="active">Peptides</a>
      <a href="coaching.html">Coaching</a>
      <a href="https://blog.minmaxmuscle.com">Blog</a>
      <a href="https://blog.minmaxmuscle.com/forum">Forums</a>
      <a href="contact.html">Contact</a>
    </nav>

    <div class="hamburger" id="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <div class="mobile-menu" id="mobileMenu">
    <a href="index.html">Home</a>
    <a href="training.html">Training</a>
    <a href="nutrition.html">Nutrition</a>
    <a href="peptidesdb.html">Peptides</a>
    <a href="coaching.html">Coaching</a>
    <a href="https://blog.minmaxmuscle.com">Blog</a>
    <a href="https://blog.minmaxmuscle.com/forum">Forums</a>
    <a href="contact.html">Contact</a>
  </div>
</header>

<!-- ================= MAIN ================= -->
<main>
  <section class="hero">
    <h1>Peptides With Intent</h1>
    <p>
      This page lists peptides currently being tested or discussed in research and clinical settings,
      ranked by general online popularity. Descriptions summarize common claims seen online and are
      provided for education only.
    </p>
  </section>

  <section>
    <h2>Popularity-Ranked Peptide List</h2>
    <p>
      Ranking reflects how frequently these peptides are discussed online and in research circles,
      not a recommendation to use them. Popularity can change quickly as new trials and media coverage appear.
    </p>
  </section>

  <section class="peptide-list">
    <p class="peptide-status" id="peptideStatus">Loading the latest peptide directory…</p>
    <ol id="peptideList"></ol>
  </section>

  <section>
    <h2>Peptide Resources</h2>
    <p>Explore supporting pages to dig deeper into stacks and safety notes.</p>
    <div class="resource-grid">
      <a class="resource-card" href="peptide-stacks.html">
        <h3>Peptide Stacks</h3>
        <p>Community stack patterns and typical combinations.</p>
      </a>
      <a class="resource-card" href="peptides/disclaimer.html">
        <h3>Disclaimer</h3>
        <p>Scope, compliance notes, and risk awareness.</p>
      </a>
    </div>
  </section>
</main>

<!-- ================= FOOTER ================= -->
<footer>
  © MinMaxMuscle. Discipline builds the body. Systems keep it.
</footer>

<script src="assets/js/script.js"></script>
<script>
  const peptideList = document.getElementById("peptideList");
  const peptideStatus = document.getElementById("peptideStatus");

  const renderPeptides = (items) => {
    peptideList.innerHTML = "";
    items.forEach((item) => {
      const listItem = document.createElement("li");
      const link = document.createElement("a");
      link.className = "peptide-link";
      link.href = `/peptides/${item.slug}`;
      link.textContent = item.peptide_name;

      const title = document.createElement("h3");
      title.appendChild(link);

      const summary = document.createElement("p");
      summary.textContent = item.research_summary || "No summary available yet.";

      const tag = document.createElement("span");
      tag.className = "peptide-tag";
      tag.textContent = item.category || "Research";

      listItem.append(title, summary, tag);
      peptideList.appendChild(listItem);
    });
  };

  const showFallback = (message) => {
    peptideStatus.textContent = message;
    peptideStatus.style.display = "block";
  };

  fetch("/api/peptides")
    .then(async (response) => {
      const contentType = response.headers.get("content-type") || "";
      if (!contentType.includes("application/json")) {
        const text = await response.text();
        throw new Error(`Unexpected response (${response.status}). ${text.slice(0, 160)}`);
      }
      const payload = await response.json();
      if (!response.ok) {
        const detail = payload?.detail ? ` (${payload.detail})` : "";
        throw new Error(`${payload?.error || "Failed to load peptides."}${detail}`);
      }
      return payload;
    })
    .then(({ data }) => {
      if (!data || data.length === 0) {
        showFallback("No peptides are available right now. Please check back soon.");
        return;
      }
      peptideStatus.style.display = "none";
      renderPeptides(data);
    })
    .catch((error) => {
      showFallback(`We couldn't load the peptide directory. ${error.message}`);
    });
</script>
</body>
</html>
